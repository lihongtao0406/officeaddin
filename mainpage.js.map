{"version":3,"file":"mainpage.js","mappings":"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","sources":["webpack://office-addin-taskpane-js/webpack/bootstrap","webpack://office-addin-taskpane-js/webpack/runtime/global","webpack://office-addin-taskpane-js/webpack/runtime/hasOwnProperty shorthand","webpack://office-addin-taskpane-js/webpack/runtime/publicPath","webpack://office-addin-taskpane-js/webpack/runtime/jsonp chunk loading","webpack://office-addin-taskpane-js/./src/mainpage/maincrm.js","webpack://office-addin-taskpane-js/./src/mainpage/crm.html"],"sourcesContent":["// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","var scriptUrl;\nif (__webpack_require__.g.importScripts) scriptUrl = __webpack_require__.g.location + \"\";\nvar document = __webpack_require__.g.document;\nif (!scriptUrl && document) {\n\tif (document.currentScript && document.currentScript.tagName.toUpperCase() === 'SCRIPT')\n\t\tscriptUrl = document.currentScript.src;\n\tif (!scriptUrl) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tif(scripts.length) {\n\t\t\tvar i = scripts.length - 1;\n\t\t\twhile (i > -1 && (!scriptUrl || !/^http(s?):/.test(scriptUrl))) scriptUrl = scripts[i--].src;\n\t\t}\n\t}\n}\n// When supporting browsers where an automatic publicPath is not supported you must specify an output.publicPath manually via configuration\n// or pass an empty string (\"\") and set the __webpack_public_path__ variable from your code to use your own logic.\nif (!scriptUrl) throw new Error(\"Automatic publicPath is not supported in this browser\");\nscriptUrl = scriptUrl.replace(/^blob:/, \"\").replace(/#.*$/, \"\").replace(/\\?.*$/, \"\").replace(/\\/[^\\/]+$/, \"/\");\n__webpack_require__.p = scriptUrl;","__webpack_require__.b = document.baseURI || self.location.href;\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t265: 0\n};\n\n// no chunk on demand loading\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n// no on chunks loaded\n\n// no jsonp function","/* eslint-disable */\r\nOffice.onReady((info) => {\r\n    if (info.host === Office.HostType.Outlook) {\r\n        checkLoginStatus();\r\n        document.getElementById(\"myButton\").onclick = openDialog;\r\n    }\r\n});\r\nlet dialog;\r\nasync function openDialog() {\r\n    // display overlay\r\n    document.getElementById(\"overlay\").style.display = \"block\";\r\n\r\n    const groupOptions = Array.from(document.getElementById(\"group-data\").options).map(option => ({\r\n        value: option.value,\r\n        text: option.text,\r\n        selected: option.selected\r\n    }));\r\n\r\n    const clientOptions = Array.from(document.getElementById(\"client\").options).map(option => ({\r\n        value: option.value,\r\n        text: option.text,\r\n        selected: option.selected\r\n    }));\r\n\r\n    const noteTitle = document.getElementById(\"noteTitle\").value;\r\n    const noteContent = window.editorInstance.getData();\r\n    const attachments = await getAttachments();\r\n    const data = { groupOptions, clientOptions, noteTitle, noteContent, attachments };\r\n    localStorage.setItem('current_login_userId', userId);\r\n    localStorage.setItem(\"dialogData\", JSON.stringify(data));\r\n\r\n    Office.context.ui.displayDialogAsync(\r\n        'https://52.62.87.63/newjob.html',\r\n        { height: 70, width: 70 },\r\n        function (asyncResult) {\r\n            if (asyncResult.status === Office.AsyncResultStatus.Succeeded) {\r\n                dialog = asyncResult.value;\r\n                dialog.addEventHandler(Office.EventType.DialogEventReceived, closeDialog);\r\n                dialog.addEventHandler(Office.EventType.DialogMessageReceived, function (arg) {\r\n                    if (arg.message === \"close\") {\r\n                        closeDialog();\r\n                    } else if (arg.message === \"newjob\") {\r\n                        console.log(\"New job added in CRM\");\r\n                        addActionInEmail();\r\n                    }\r\n                });\r\n            } else {\r\n                console.error(\"Failed to open dialog:\", asyncResult.error);\r\n            }\r\n        }\r\n    );\r\n}\r\n\r\nfunction addActionInEmail() {\r\n    const message = {\r\n        type: Office.MailboxEnums.ItemNotificationMessageType.InformationalMessage,\r\n        message: \"This email was sent to Worksorted as a new job\",\r\n        icon: \"/assets/icon-80.png\",\r\n        persistent: true,\r\n    };\r\n\r\n    // Show a notification message.\r\n    Office.context.mailbox.item.notificationMessages.replaceAsync(\"action\", message);\r\n}\r\n\r\nfunction closeDialog() {\r\n    if (dialog) {\r\n        dialog.close();\r\n    }\r\n    document.getElementById(\"overlay\").style.display = \"none\"; // close overlay\r\n}\r\n\r\nlet userId = 0;\r\n\r\nasync function checkLoginStatus() {\r\n    // Get the stored unique ID (oid) from localStorage\r\n    const storedUniqueId = localStorage.getItem('outlookuniqueId');\r\n\r\n    try {\r\n        // Send a request to your backend to check login status\r\n        const response = await fetch('http://localhost/outlookAddin/check_status.php', {\r\n            method: 'POST',\r\n            headers: {\r\n                \"Content-Type\": \"application/x-www-form-urlencoded\"\r\n            },\r\n            body: `access_token=${storedUniqueId}`\r\n        });\r\n\r\n        const data = await response.json();\r\n\r\n        if (data.status === 'success') {\r\n            userId = data.userId;\r\n            // If the user is logged in, load CRM data\r\n            loadCrmData(userId);\r\n        } else {\r\n            // If the user is not logged in, redirect to login page\r\n            //redirectToLogin();\r\n        }\r\n    } catch (error) {\r\n        console.error('Error checking login status:', error);\r\n        // If there's an error, redirect to login page as a fallback\r\n        //redirectToLogin();\r\n    }\r\n}\r\n\r\nfunction redirectToLogin() {\r\n    // Clear the stored unique ID\r\n    localStorage.removeItem('outlookuniqueId');\r\n\r\n    // Redirect to the login page\r\n    window.location.href = 'taskpane.html'; // Replace with your login page URL\r\n}\r\n\r\nfunction loadCrmData(userId) {\r\n    // Your existing logic to load CRM data\r\n    console.log('Loading CRM data...', userId);\r\n    document.getElementById('crmData').innerHTML = '<h1>Welcome</h1>';\r\n    document.getElementById('toggleSidebar').addEventListener('click', toggleSidebar);\r\n    document.getElementById('arrow-left').addEventListener('click', toggleSidebar1);\r\n\r\n    // group\r\n    fetchGroups(userId).then(groups => {\r\n        const groupSelect = document.getElementById(\"group-data\");\r\n        groupSelect.innerHTML = \"\";\r\n        if (groups.length === 0) {\r\n            groupSelect.innerHTML = '<option value=\"0\">No Groups Found</option>';\r\n            return;\r\n        }\r\n        groups.forEach(group => {\r\n            const option = document.createElement(\"option\");\r\n            option.value = group.groupId;\r\n            option.textContent = group.groupName;\r\n\r\n            option.dataset.xplan_emailSuffix = group.pushEmailAddress || \"\";\r\n            option.dataset.salesforce_emailSuffix = group.salesforceEmail || \"\";\r\n            option.dataset.midwinter_emailSuffix = group.MidwinterEmail || \"\";\r\n\r\n            groupSelect.appendChild(option);\r\n        });\r\n        groupSelect.value = groups[0].groupId;\r\n\r\n\r\n        loadClients(groups[0].groupId);\r\n    });\r\n    loadEmailContent();\r\n}\r\n\r\n$(\"#group-data\").on(\"change\", function () {\r\n    const selectedGroupId = this.value;\r\n    if (selectedGroupId) {\r\n        loadClients(selectedGroupId);\r\n\r\n        if (document.getElementById(\"category\").checked) {\r\n            loadCategories(selectedGroupId);\r\n        }\r\n        if (document.getElementById(\"sharenote\").checked) {\r\n            loadSharedClient(selectedGroupId, document.getElementById(\"client\").value);\r\n        }\r\n    }\r\n});\r\n\r\nfunction toggleSidebar() {\r\n    const sidebar = document.getElementById('sidebar');\r\n    console.log('Toggling sidebar...', sidebar);\r\n    sidebar.classList.add('active');\r\n}\r\nfunction toggleSidebar1() {\r\n    const sidebar = document.getElementById('sidebar');\r\n    console.log('Toggling sidebar...', sidebar);\r\n    sidebar.classList.remove('active');\r\n}\r\n\r\nfunction loadEmailContent() {\r\n    // Get the email body content\r\n    Office.context.mailbox.item.body.getAsync(Office.CoercionType.Html, (result) => {\r\n        if (result.status === Office.AsyncResultStatus.Succeeded) {\r\n            const emailContent = result.value;\r\n            const emailSubject = Office.context.mailbox.item.subject;\r\n            const from = Office.context.mailbox.item.from;\r\n            const fromName = from.displayName || from.emailAddress;\r\n            const toRecipients = Office.context.mailbox.item.to;\r\n            const toNames = toRecipients.map(recipient => recipient.displayName || recipient.emailAddress).join(', ');\r\n            const receivedTime = new Date(Office.context.mailbox.item.dateTimeCreated).toLocaleString();\r\n\r\n            const infoDiv = `\r\n                <div>\r\n                    IMPORTED FROM OUTLOOK<br>\r\n                    <strong>From:</strong> ${fromName}<br>\r\n                    <strong>To:</strong> ${toNames}<br>\r\n                    <strong>Received at:</strong> ${receivedTime}<br>\r\n                    &mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;\r\n                </div>\r\n                    `;\r\n            const fullContent = emailContent.includes('<body')\r\n                ? emailContent.replace(/<body[^>]*>/i, (match) => `${match}${infoDiv}`)\r\n                : `${infoDiv}${emailContent}`;\r\n            const editor = window.editorInstance;\r\n            // Set the email content in the Quill editor\r\n            if (editor) {\r\n                // Set the email content in CKEditor\r\n                editor.setData(fullContent);\r\n                document.getElementById('noteTitle').value = emailSubject;\r\n            } else {\r\n                console.error('CKEditor instance is not available.');\r\n            }\r\n        } else {\r\n            console.error('Failed to load email content:', result.error);\r\n        }\r\n    });\r\n}\r\n\r\nfunction fetchGroups(userId) {\r\n    return fetch(`http://localhost/outlookAddin/webgetGroups.php?userId=${userId}`)\r\n        .then(response => response.json())\r\n        .catch(error => {\r\n            console.error(\"Error fetching groups:\", error);\r\n            return [];\r\n        });\r\n}\r\n\r\nfunction fetchClients(groupId) {\r\n    return fetch(`http://localhost/outlookAddin/webgetEntities.php?groupId=${groupId}`)\r\n        .then(response => response.json())\r\n        .catch(error => {\r\n            console.error(\"Error fetching clients:\", error);\r\n            return [];\r\n        });\r\n}\r\n\r\nfunction loadClients(groupId) {\r\n    fetchClients(groupId).then(clients => {\r\n        const clientSelect = document.getElementById(\"client\");\r\n        clientSelect.innerHTML = \"\";\r\n\r\n        if (clients.length === 0) {\r\n            //clientSelect.append('<option value=\"\">No Clients Found</option>');\r\n            clientSelect.innerHTML = '<option value=\"\">No Clients Found</option>';\r\n            return;\r\n        }\r\n        clients.forEach(client => {\r\n            const option = document.createElement(\"option\");\r\n            option.value = client.entityId;\r\n            option.textContent = `${client.entityName} - ${client.entityId}`;\r\n\r\n            option.dataset.xplanEmail = client.XPlanID || \"\";\r\n            option.dataset.salesforceEmail = client.SalesforceID || \"\";\r\n            option.dataset.midwinterEmail = client.MidwinterID || \"\";\r\n            clientSelect.appendChild(option);\r\n        });\r\n\r\n        $(clientSelect).select2({\r\n            placeholder: \"Search or select a client\",\r\n            allowClear: true\r\n        });\r\n\r\n        if (clients.length > 0) {\r\n            clientSelect.value = clients[0].entityId;\r\n            $(clientSelect).trigger(\"change\");\r\n        }\r\n\r\n    });\r\n}\r\n\r\n$(\"#client\").on(\"change\", function () {\r\n    console.log(\"Selected Client ID:\", $(this).val());\r\n    const groupId = document.getElementById(\"group-data\").value;\r\n    const xplanEmailCheckbox = document.getElementById(\"xplan-email-label\");\r\n    const salesforceEmailCheckbox = document.getElementById(\"saleforce-email-label\");\r\n    const midwinterEmailCheckbox = document.getElementById(\"midwinter-email-label\");\r\n    xplanEmailCheckbox.checked = false;\r\n    salesforceEmailCheckbox.checked = false;\r\n    midwinterEmailCheckbox.checked = false;\r\n\r\n    const selectedOption = this.options[this.selectedIndex];\r\n    const xplanEmail = selectedOption?.dataset.xplanEmail || \"\";\r\n    const salesforceEmail = selectedOption?.dataset.salesforceEmail || \"\";\r\n    const midwinterEmail = selectedOption?.dataset.midwinterEmail || \"\";\r\n\r\n    if (xplanEmail.trim() !== \"\") {\r\n        document.getElementById(\"xplan-email\").style.display = \"block\";\r\n        document.getElementById(\"xplan-email-label\").value = xplanEmail;\r\n    } else {\r\n        document.getElementById(\"xplan-email\").style.display = \"none\";\r\n    }\r\n\r\n    if (salesforceEmail.trim() !== \"\") {\r\n        document.getElementById(\"saleforce-email\").style.display = \"block\";\r\n        document.getElementById(\"saleforce-email-label\").value = salesforceEmail;\r\n    } else {\r\n        document.getElementById(\"saleforce-email\").style.display = \"none\";\r\n    }\r\n\r\n    if (midwinterEmail.trim() !== \"\") {\r\n        document.getElementById(\"midwinter-email\").style.display = \"block\";\r\n        document.getElementById(\"midwinter-email-label\").value = midwinterEmail;\r\n    } else {\r\n        document.getElementById(\"midwinter-email\").style.display = \"none\";\r\n    }\r\n\r\n    const xplan_emailDiv = document.getElementById(\"xplan-email-txt\");\r\n    if (xplan_emailDiv) {\r\n        document.getElementById(\"xplan-email\").removeChild(xplan_emailDiv);\r\n    }\r\n\r\n    const saleforce_emailDiv = document.getElementById(\"salesforce-email-txt\");\r\n    if (saleforce_emailDiv) {\r\n        document.getElementById(\"saleforce-email\").removeChild(saleforce_emailDiv);\r\n    }\r\n\r\n    const midwinter_emailDiv = document.getElementById(\"midwinter-email-txt\");\r\n    if (midwinter_emailDiv) {\r\n        document.getElementById(\"midwinter-email\").removeChild(midwinter_emailDiv);\r\n    }\r\n\r\n\r\n    if (document.getElementById(\"sharenote\").checked) {\r\n        loadSharedClient(groupId, $(this).val());\r\n    }\r\n\r\n    if (document.getElementById(\"notetype\").value === \"1\") {\r\n        loadClientJob(groupId, $(this).val());\r\n    }\r\n\r\n    if (document.getElementById(\"notetype\").value === \"2\") {\r\n        loadClientJob(groupId, \"noEitityId\");\r\n    }\r\n});\r\n\r\ndocument.getElementById(\"category\").addEventListener(\"change\", function () {\r\n    const categoryContainer = document.getElementById(\"category-container\");\r\n    const groupSelect = document.getElementById(\"group-data\");\r\n    if (this.checked) {\r\n        categoryContainer.style.display = \"block\";\r\n        if (groupSelect.value) {\r\n            loadCategories(groupSelect.value);\r\n        }\r\n    } else {\r\n        categoryContainer.style.display = \"none\";\r\n    }\r\n});\r\n\r\n\r\nfunction loadCategories(groupId) {\r\n    fetch(`http://localhost/outlookAddin/webgetNoteCategories.php?groupId=${groupId}`)\r\n        .then(response => response.json())\r\n        .then(categories => {\r\n            const categorySelect = document.getElementById(\"category-select\");\r\n            categorySelect.innerHTML = '<option value=\"\">Select Category</option>';\r\n\r\n            categories.forEach(category => {\r\n                const option = document.createElement(\"option\");\r\n                option.value = category.notecategoryId;\r\n                option.textContent = category.notecategoryName;\r\n                categorySelect.appendChild(option);\r\n            });\r\n            categorySelect.style.display = 'inline';\r\n            loadSubCategories(groupId, categorySelect.value);\r\n        })\r\n        .catch(error => {\r\n            console.error(\"Error loading categories:\", error);\r\n        });\r\n}\r\n\r\n// listen to category change event\r\ndocument.getElementById(\"category-select\").addEventListener(\"change\", function () {\r\n    const categoryId = this.value;\r\n    const groupId = document.getElementById(\"group-data\").value;\r\n    if (categoryId && groupId) {\r\n        loadSubCategories(groupId, categoryId);\r\n    } else {\r\n        document.getElementById(\"sub-category-select\").style.display = \"none\"; // hide Sub-category option\r\n    }\r\n});\r\n\r\n// according to the selected category, load sub-categories\r\nfunction loadSubCategories(groupId, categoryId) {\r\n    fetch(`http://localhost/outlookAddin/webgetSubNoteCategories.php?groupId=${groupId}&categoryId=${categoryId}`)\r\n        .then(response => response.json())\r\n        .then(subCategories => {\r\n            const subCategorySelect = document.getElementById(\"sub-category-select\");\r\n            subCategorySelect.innerHTML = '<option value=\"\">Select Sub-Category</option>'; // clear all options\r\n\r\n            if (subCategories.length > 0) {\r\n                subCategories.forEach(subCategory => {\r\n                    const option = document.createElement(\"option\");\r\n                    option.value = subCategory.id;\r\n                    option.textContent = subCategory.name;\r\n                    subCategorySelect.appendChild(option);\r\n                });\r\n                subCategorySelect.style.display = 'inline'; // display Sub-category select box\r\n            } else {\r\n                subCategorySelect.style.display = 'none'; // for no sub-category, hide the select box\r\n            }\r\n        })\r\n        .catch(error => {\r\n            console.error(\"Error loading sub-categories:\", error);\r\n        });\r\n}\r\n\r\n// share note with listener\r\ndocument.getElementById(\"sharenote\").addEventListener(\"change\", function () {\r\n    const shareNoteContainer = document.getElementById(\"sharenote-container\");\r\n    if (this.checked) {\r\n        shareNoteContainer.style.display = \"block\";\r\n        const groupId = document.getElementById(\"group-data\").value;\r\n        const entityId = document.getElementById(\"client\").value;\r\n        loadSharedClient(groupId, entityId);\r\n        console.log(\"Group ID:\", groupId);\r\n        console.log(\"Entity ID:\", entityId);\r\n    } else {\r\n        shareNoteContainer.style.display = \"none\";\r\n    }\r\n});\r\n\r\nfunction loadSharedClient(groupId, entityId) {\r\n    fetch(`http://localhost/outlookAddin/webgetEntityShare.php?groupId=${groupId}&entityId=${entityId}`)\r\n        .then(response => response.json())\r\n        .then(entities => {\r\n            const sharenoteSelect = document.getElementById(\"sharenote-select\");\r\n            sharenoteSelect.innerHTML = \"<option value=''>Select User</option>\";\r\n            if (Array.isArray(entities)) {\r\n                entities.forEach(entity => {\r\n                    const option = document.createElement(\"option\");\r\n                    option.value = entity.entityId;\r\n                    option.textContent = entity.entityName;\r\n                    sharenoteSelect.appendChild(option);\r\n                });\r\n            }\r\n\r\n            $(sharenoteSelect).select2(\r\n                {\r\n                    placeholder: \"Related client\",\r\n                    allowClear: true\r\n                });\r\n        })\r\n        .catch(error => {\r\n            console.error(\"Error loading users:\", error);\r\n        });\r\n}\r\n\r\ndocument.getElementById(\"add-file-note-btn\").addEventListener(\"click\", async function () {\r\n    let attachmentIds = [];\r\n    const selectedRadio = document.querySelector('input[name=\"attachmentOption\"]:checked');\r\n    if (selectedRadio && selectedRadio.value === \"1\") {\r\n        try {\r\n            const attachmentData = await getAttachments();\r\n            console.log(\"Attachment Data:\", attachmentData);\r\n\r\n            const response = await sendAttachmentsToServer(attachmentData);\r\n            attachmentIds = response;\r\n            console.log(\"Attachment IDs:\", attachmentIds);\r\n        } catch (error) {\r\n            console.error(\"Error sending attachments:\", error);\r\n        }\r\n    } else {\r\n        attachmentIds = [];\r\n    }\r\n\r\n    const selectGroupId = document.getElementById(\"group-data\").value;\r\n    const selectClientId = document.getElementById(\"client\").value;\r\n    let effectiveDateTimeValue = '';\r\n    // check effectiveDateTime \r\n    if (document.getElementById(\"effectiveDateTime\").checked) {\r\n        effectiveDateTimeValue = document.getElementById(\"datetime-picker\").value;\r\n        if (effectiveDateTimeValue.trim() === \"\") {\r\n            effectiveDateTimeValue = '';\r\n        }\r\n    }\r\n\r\n    // check category\r\n    let categoryId = '';\r\n    let subCategoryId = '';\r\n    if (document.getElementById(\"category\").checked) {\r\n        categoryId = document.getElementById(\"category-select\").value;\r\n        subCategoryId = document.getElementById(\"sub-category-select\").value;\r\n    }\r\n\r\n    // check share note\r\n    let shareNote = [];\r\n    if (document.getElementById(\"sharenote\").checked) {\r\n        const selectedOptions = Array.from(document.getElementById(\"sharenote-select\").selectedOptions);\r\n        const values = selectedOptions.map(option => option.value);\r\n        shareNote = values;\r\n    }\r\n\r\n    // check send copy of email\r\n    let xplanEmail = '';\r\n    let salesforceEmail = '';\r\n    let midwinterEmail = '';\r\n    if (document.getElementById(\"xplan-email-label\").checked) {\r\n        xplanEmail = document.getElementById(\"xplan-email-label\").value;\r\n    }\r\n    if (document.getElementById(\"saleforce-email-label\").checked) {\r\n        salesforceEmail = document.getElementById(\"saleforce-email-label\").value;\r\n    }\r\n    if (document.getElementById(\"midwinter-email-label\").checked) {\r\n        midwinterEmail = document.getElementById(\"midwinter-email-label\").value;\r\n    }\r\n\r\n    const noteTitle = document.getElementById(\"noteTitle\").value;\r\n    const noteContent = window.editorInstance.getData();\r\n\r\n    const groupSelect = document.getElementById(\"group-data\");\r\n    const selectedOption = groupSelect.options[groupSelect.selectedIndex];\r\n    const xplan_emailSuffix = selectedOption.dataset.xplan_emailSuffix || \"\";\r\n    const salesforce_emailSuffix = selectedOption.dataset.salesforce_emailSuffix || \"\";\r\n    const midwinter_emailSuffix = selectedOption.dataset.midwinter_emailSuffix || \"\";\r\n\r\n    // send email to xplan, salesforce, midwinter\r\n    if (xplanEmail && xplan_emailSuffix) {\r\n        const actualXplanEmail = xplanEmail + '@' + xplan_emailSuffix;\r\n        sendEmail(noteTitle, noteContent, actualXplanEmail, xplanEmail);\r\n    }\r\n\r\n    if (salesforceEmail && salesforce_emailSuffix) {\r\n        const actualSalesforceEmail = salesforce_emailSuffix;\r\n        sendEmail(noteTitle, noteContent, actualSalesforceEmail, salesforceEmail);\r\n    }\r\n\r\n    if (midwinterEmail && midwinter_emailSuffix) {\r\n        const actualMidwinterEmail = midwinter_emailSuffix;\r\n        sendEmail(noteTitle, noteContent, actualMidwinterEmail, midwinterEmail);\r\n    }\r\n\r\n    console.log(\"Attachment IDs1234:\", attachmentIds);\r\n    // add file note to server\r\n    try {\r\n        const response = await fetch('http://localhost/outlookAddin/webaddFileNote.php', {\r\n            method: 'POST',\r\n            headers: {\r\n                \"Content-Type\": \"application/x-www-form-urlencoded\"\r\n            },\r\n            body: `userId=${userId}&groupId=${selectGroupId}&entityId=${selectClientId}&noteTitle=${noteTitle}&noteContent=${encodeURIComponent(noteContent)}&categoryId=${categoryId}&subCategoryId=${subCategoryId}&shareNote=${shareNote.join(\",\")}&xplanEmail=${xplanEmail}&salesforceEmail=${salesforceEmail}&midwinterEmail=${midwinterEmail}&effectiveDateTime=${effectiveDateTimeValue}&attachmentIds=${attachmentIds.join(\",\")}`\r\n        });\r\n\r\n        const data = await response.json();\r\n        if (data.status === \"success\") {\r\n            const message = {\r\n                type: Office.MailboxEnums.ItemNotificationMessageType.InformationalMessage,\r\n                message: \"This email was sent to Worksorted\",\r\n                icon: \"/assets/icon-80.png\",\r\n                persistent: true,\r\n            };\r\n\r\n            // Show a notification message.\r\n            Office.context.mailbox.item.notificationMessages.replaceAsync(\"action\", message);\r\n\r\n            // Open a dialog to show the success message\r\n            const overlay = document.createElement('div');\r\n            overlay.className = 'overlay';\r\n            document.body.appendChild(overlay);\r\n\r\n            // create a dialog\r\n            const dialog = document.createElement('div');\r\n            dialog.className = 'dialog';\r\n            dialog.innerHTML = `\r\n                <p>Successfully Add</p>\r\n                <button id=\"close-dialog\">OK</button>\r\n            `;\r\n            document.body.appendChild(dialog);\r\n            document.getElementById('close-dialog').addEventListener('click', () => {\r\n                document.body.removeChild(dialog);\r\n                document.body.removeChild(overlay);\r\n                location.reload();\r\n            });\r\n        } else {\r\n            console.log(\"Failed to add file note.\");\r\n        }\r\n    } catch (error) {\r\n        console.error(\"Error adding file note:\", error);\r\n    }\r\n\r\n});\r\n\r\nasync function getAttachments() {\r\n    return new Promise((resolve, reject) => {\r\n        const item = Office.context.mailbox.item;\r\n\r\n        if (item && item.attachments) {\r\n            let attachments = item.attachments;\r\n\r\n            // list to store attachment data\r\n            let attachmentData = [];\r\n\r\n            attachments.forEach((attachment) => {\r\n                if (attachment.attachmentType === \"file\") {\r\n                    // use getAttachmentContentAsync to get the attachment content\r\n                    Office.context.mailbox.item.getAttachmentContentAsync(attachment.id, function (asyncResult) {\r\n                        console.log(\"Item:11221\");\r\n                        if (asyncResult.status === Office.AsyncResultStatus.Succeeded) {\r\n                            attachmentData.push({\r\n                                fileName: attachment.name,\r\n                                fileContent: asyncResult.value.content,  // base64 encoded content\r\n                                fileType: attachment.contentType,\r\n                                fileSize: attachment.size\r\n                            });\r\n\r\n                            // check if all attachments are fetched\r\n                            if (attachmentData.length === attachments.length) {\r\n                                resolve(attachmentData);\r\n                            }\r\n                        } else {\r\n                            reject(\"Failed to get attachment content.\");\r\n                        }\r\n                    });\r\n                }\r\n            });\r\n\r\n            // if no file attachments found\r\n            if (attachments.length === 0) {\r\n                resolve([]);\r\n            }\r\n        } else {\r\n            reject(\"No attachments found.\");\r\n        }\r\n    });\r\n}\r\n\r\nasync function sendAttachmentsToServer(attachmentData) {\r\n    const response = await fetch('http://localhost/outlookAddin/webattachmentReceiver.php', {\r\n        method: 'POST',\r\n        headers: {\r\n            \"Content-Type\": \"application/x-www-form-urlencoded\"\r\n        },\r\n        body: \"attachments=\" + encodeURIComponent(JSON.stringify(attachmentData))\r\n    });\r\n\r\n    const data = await response.json();\r\n\r\n    if (data.status === \"success\" && data.attachmentIds) {\r\n        return data.attachmentIds;  // return the attachmentIds\r\n    } else {\r\n        throw new Error(\"No attachment IDs returned from server.\");\r\n    }\r\n}\r\n\r\n$(\"#notetype\").on(\"change\", function () {\r\n    console.log('Selected value:', document.getElementById(\"notetype\").value);\r\n    const noteType = this.value;\r\n    const clientSelect = document.getElementById(\"client\");\r\n    if (noteType === \"0\") {\r\n        document.getElementById(\"job-box\").style.display = \"none\";\r\n        document.getElementById(\"jobnote-option\").style.display = \"none\";\r\n        document.getElementById(\"filenote-option\").style.display = \"block\";\r\n        clientSelect.disabled = false;\r\n        document.getElementById(\"xplan-email-label\").disabled = false;\r\n        document.getElementById(\"saleforce-email-label\").disabled = false;\r\n        document.getElementById(\"midwinter-email-label\").disabled = false;\r\n    } else if (noteType === \"1\") {\r\n        document.getElementById(\"job-box\").style.display = \"block\";\r\n        document.getElementById(\"jobnote-option\").style.display = \"block\";\r\n        document.getElementById(\"filenote-option\").style.display = \"none\";\r\n        const currentGroupId = document.getElementById(\"group-data\").value;\r\n        const currentEntityId = document.getElementById(\"client\").value;\r\n        clientSelect.disabled = false;\r\n        loadClientJob(currentGroupId, currentEntityId);\r\n        document.getElementById(\"xplan-email-label\").disabled = false;\r\n        document.getElementById(\"saleforce-email-label\").disabled = false;\r\n        document.getElementById(\"midwinter-email-label\").disabled = false;\r\n    } else {\r\n        document.getElementById(\"job-box\").style.display = \"block\";\r\n        document.getElementById(\"jobnote-option\").style.display = \"block\";\r\n        document.getElementById(\"filenote-option\").style.display = \"none\";\r\n        const currentGroupId = document.getElementById(\"group-data\").value;\r\n        loadClientJob(currentGroupId, \"noEitityId\");\r\n        clientSelect.disabled = true;\r\n        document.getElementById(\"xplan-email-label\").disabled = true;\r\n        document.getElementById(\"saleforce-email-label\").disabled = true;\r\n        document.getElementById(\"midwinter-email-label\").disabled = true;\r\n    }\r\n});\r\n\r\nfunction loadClientJob(groupId, entityId) {\r\n    fetch(`http://localhost/outlookAddin/webgetClientJobs.php?groupId=${groupId}&entityId=${entityId}`)\r\n        .then(response => response.json())\r\n        .then(jobs => {\r\n            const jobSelect = document.getElementById(\"job\");\r\n            jobSelect.innerHTML = \"<option value=''>Select Job</option>\";\r\n            jobs.forEach(job => {\r\n                const option = document.createElement(\"option\");\r\n                option.value = job.jobId;\r\n                option.textContent = job.jobTitle;\r\n                jobSelect.appendChild(option);\r\n            });\r\n            $(jobSelect).select2({\r\n                placeholder: \"Search or select a job\",\r\n                allowClear: true\r\n            });\r\n        })\r\n        .catch(error => {\r\n            console.error(\"Error loading jobs:\", error);\r\n        });\r\n}\r\n\r\ndocument.getElementById(\"add-job-note-btn\").addEventListener(\"click\", async function () {\r\n    let attachmentIds = [];\r\n    const selectedRadio = document.querySelector('input[name=\"attachmentOption\"]:checked');\r\n    if (selectedRadio && selectedRadio.value === \"1\") {\r\n        try {\r\n            const attachmentData = await getAttachments();\r\n            console.log(\"Attachment Data:\", attachmentData);\r\n\r\n            const response = await sendAttachmentsToServer(attachmentData);\r\n            attachmentIds = response;\r\n            console.log(\"Attachment IDs:\", attachmentIds);\r\n        } catch (error) {\r\n            console.error(\"Error sending attachments:\", error);\r\n        }\r\n    } else {\r\n        attachmentIds = [];\r\n    }\r\n\r\n    const selectGroupId = document.getElementById(\"group-data\").value;\r\n    const selectClientId = document.getElementById(\"client\").value;\r\n    let dueDateValue = '';\r\n    // check due date \r\n    if (document.getElementById(\"jobnote-duedate\").checked) {\r\n        dueDateValue = document.getElementById(\"jobnote-duedate-picker\").value;\r\n        if (dueDateValue.trim() === \"\") {\r\n            dueDateValue = '';\r\n        }\r\n    }\r\n\r\n    // check follow up date\r\n    let followUpDateValue = '';\r\n    if (document.getElementById(\"jobnote-followupdate\").checked) {\r\n        followUpDateValue = document.getElementById(\"jobnote-followupdate-picker\").value;\r\n        if (followUpDateValue.trim() === \"\") {\r\n            followUpDateValue = '';\r\n        }\r\n    }\r\n\r\n    // check effectiveDateTime\r\n    let effectiveDateValue = '';\r\n    if (document.getElementById(\"jobnote-effectivedate\").checked) {\r\n        effectiveDateValue = document.getElementById(\"jobnote-effectivedate-picker\").value;\r\n        if (effectiveDateValue.trim() === \"\") {\r\n            effectiveDateValue = '';\r\n        }\r\n    }\r\n\r\n    // check close job\r\n    let closejob = 0;\r\n    let closeJob_hrs = '';\r\n    let closeJob_mins = '';\r\n    if (document.getElementById(\"closejob\").checked) {\r\n        closejob = 1;\r\n        closeJob_hrs = document.getElementById(\"closejob-hours\").value;\r\n        closeJob_mins = document.getElementById(\"closejob-minutes\").value;\r\n    } else {\r\n        closejob = 0;\r\n    }\r\n\r\n    // check notify owner\r\n    let notifyOwner = '';\r\n    if (document.getElementById(\"jobnote-owner\").checked) {\r\n        notifyOwner = 1;\r\n    } else {\r\n        notifyOwner = 0;\r\n    }\r\n\r\n    // check notify assigned to\r\n    let notifyAssignedTo = '';\r\n    if (document.getElementById(\"jobnote-assigned\").checked) {\r\n        notifyAssignedTo = 1;\r\n    } else {\r\n        notifyAssignedTo = 0;\r\n    }\r\n\r\n    // check notify observer\r\n    let notifyObserver = '';\r\n    if (document.getElementById(\"jobnote-observer\").checked) {\r\n        notifyObserver = 1;\r\n    } else {\r\n        notifyObserver = 0;\r\n    }\r\n\r\n    // check send copy of email\r\n    let xplanEmail = '';\r\n    let salesforceEmail = '';\r\n    let midwinterEmail = '';\r\n    if (document.getElementById(\"xplan-email-label\").checked) {\r\n        xplanEmail = document.getElementById(\"xplan-email-label\").value;\r\n    }\r\n    if (document.getElementById(\"saleforce-email-label\").checked) {\r\n        salesforceEmail = document.getElementById(\"saleforce-email-label\").value;\r\n    }\r\n    if (document.getElementById(\"midwinter-email-label\").checked) {\r\n        midwinterEmail = document.getElementById(\"midwinter-email-label\").value;\r\n    }\r\n\r\n    const noteTitle = document.getElementById(\"noteTitle\").value;\r\n    const noteContent = window.editorInstance.getData();\r\n\r\n    const groupSelect = document.getElementById(\"group-data\");\r\n    const selectedOption = groupSelect.options[groupSelect.selectedIndex];\r\n    const xplan_emailSuffix = selectedOption.dataset.xplan_emailSuffix || \"\";\r\n    const salesforce_emailSuffix = selectedOption.dataset.salesforce_emailSuffix || \"\";\r\n    const midwinter_emailSuffix = selectedOption.dataset.midwinter_emailSuffix || \"\";\r\n\r\n\r\n    if (document.getElementById(\"notetype\").value === \"2\") {\r\n        // send email to xplan, salesforce, midwinter\r\n        if (!xplanEmail && !xplan_emailSuffix) {\r\n            const actualXplanEmail = xplanEmail + '@' + xplan_emailSuffix;\r\n            sendEmail(noteTitle, noteContent, actualXplanEmail, xplanEmail);\r\n        }\r\n\r\n        if (!salesforceEmail && !salesforce_emailSuffix) {\r\n            const actualSalesforceEmail = salesforce_emailSuffix;\r\n            sendEmail(noteTitle, noteContent, actualSalesforceEmail, salesforceEmail);\r\n        }\r\n\r\n        if (!midwinterEmail && !midwinter_emailSuffix) {\r\n            const actualMidwinterEmail = midwinter_emailSuffix;\r\n            sendEmail(noteTitle, noteContent, actualMidwinterEmail, midwinterEmail);\r\n        }\r\n    }\r\n    // get all selected job ids\r\n    let jobIds = [];\r\n    const selectedOptions = Array.from(document.getElementById(\"job\").selectedOptions);\r\n    jobIds = selectedOptions.map(option => option.value);\r\n\r\n    console.log(\"jobIds IDs1234:\", jobIds);\r\n    console.log(\"Note Conte\", noteContent);\r\n\r\n    if (document.getElementById(\"notetype\").value === \"3\") {\r\n        $entityId = \"noEitityId\";\r\n\r\n    }\r\n    // add file note to server\r\n    try {\r\n        const response = await fetch('http://localhost/outlookAddin/webaddJobNote.php', {\r\n            method: 'POST',\r\n            headers: {\r\n                \"Content-Type\": \"application/x-www-form-urlencoded\"\r\n            },\r\n            body: `userId=${userId}&groupId=${selectGroupId}&entityId=${selectClientId}&noteTitle=${noteTitle}&noteContent=${encodeURIComponent(noteContent)}&jobIds=${jobIds.join(\",\")}&duedate=${dueDateValue}&followupdate=${followUpDateValue}&effectivedate=${effectiveDateValue}&closejob=${closejob}&closeJob_hrs=${closeJob_hrs}&closeJob_mins=${closeJob_mins}&notifyOwner=${notifyOwner}&notifyAssignedTo=${notifyAssignedTo}&notifyObserver=${notifyObserver}&attachmentIds=${attachmentIds.join(\",\")}`\r\n        });\r\n\r\n        const data = await response.json();\r\n        if (data.status === \"success\") {\r\n            const message = {\r\n                type: Office.MailboxEnums.ItemNotificationMessageType.InformationalMessage,\r\n                message: \"This email was sent to Worksorted\",\r\n                icon: \"/assets/icon-80.png\",\r\n                persistent: true,\r\n            };\r\n\r\n            // Show a notification message.\r\n            Office.context.mailbox.item.notificationMessages.replaceAsync(\"action\", message);\r\n\r\n            // Open a dialog to show the success message\r\n            const overlay = document.createElement('div');\r\n            overlay.className = 'overlay';\r\n            document.body.appendChild(overlay);\r\n\r\n            // create a dialog\r\n            const dialog = document.createElement('div');\r\n            dialog.className = 'dialog';\r\n            dialog.innerHTML = `\r\n                <p>Successfully Add</p>\r\n                <button id=\"close-dialog\">OK</button>\r\n            `;\r\n            document.body.appendChild(dialog);\r\n            document.getElementById('close-dialog').addEventListener('click', () => {\r\n                document.body.removeChild(dialog);\r\n                document.body.removeChild(overlay);\r\n                location.reload();\r\n            });\r\n        } else {\r\n            console.log(\"Failed to add file note.\");\r\n        }\r\n    } catch (error) {\r\n        console.error(\"Error adding file note:\", error);\r\n    }\r\n\r\n});\r\n\r\ndocument.getElementById(\"xplan-email-label\").addEventListener(\"change\", function () {\r\n    if (this.checked) {\r\n        const xplanEmail = document.getElementById(\"xplan-email-label\").value;\r\n        const groupSelect = document.getElementById(\"group-data\");\r\n        const selectedOption = groupSelect.options[groupSelect.selectedIndex];\r\n        const xplan_emailSuffix = selectedOption.dataset.xplan_emailSuffix || \"\";\r\n        const email = xplanEmail + '@' + xplan_emailSuffix;\r\n        if (xplanEmail && xplan_emailSuffix) {\r\n            // create a txt div to show the email\r\n            const emailDiv = document.createElement('div');\r\n            emailDiv.id = \"xplan-email-txt\";\r\n            emailDiv.textContent = email;\r\n            emailDiv.style.color = \"green\";\r\n            document.getElementById(\"xplan-email\").appendChild(emailDiv);\r\n        } else {\r\n            const emailDiv = document.createElement('div');\r\n            emailDiv.id = \"xplan-email-txt\";\r\n            emailDiv.textContent = \"Invalid email address\";\r\n            // color the text red\r\n            emailDiv.style.color = \"red\";\r\n            document.getElementById(\"xplan-email\").appendChild(emailDiv);\r\n        }\r\n    } else {\r\n        // check if the email div exists\r\n        const emailDiv = document.getElementById(\"xplan-email-txt\");\r\n        if (emailDiv) {\r\n            document.getElementById(\"xplan-email\").removeChild(emailDiv);\r\n        }\r\n    }\r\n});\r\n\r\ndocument.getElementById(\"saleforce-email-label\").addEventListener(\"change\", function () {\r\n    if (this.checked) {\r\n        const salesforceEmail = document.getElementById(\"saleforce-email-label\").value;\r\n        const groupSelect = document.getElementById(\"group-data\");\r\n        const selectedOption = groupSelect.options[groupSelect.selectedIndex];\r\n        const salesforce_emailSuffix = selectedOption.dataset.salesforce_emailSuffix || \"\";\r\n        const email = salesforce_emailSuffix;\r\n        if (salesforceEmail && salesforce_emailSuffix) {\r\n            // create a txt div to show the email\r\n            const emailDiv = document.createElement('div');\r\n            emailDiv.id = \"salesforce-email-txt\";\r\n            emailDiv.textContent = email;\r\n            emailDiv.style.color = \"green\";\r\n            document.getElementById(\"saleforce-email\").appendChild(emailDiv);\r\n        } else {\r\n            const emailDiv = document.createElement('div');\r\n            emailDiv.id = \"salesforce-email-txt\";\r\n            emailDiv.textContent = \"Invalid email address\";\r\n            // color the text red\r\n            emailDiv.style.color = \"red\";\r\n            document.getElementById(\"saleforce-email\").appendChild(emailDiv);\r\n        }\r\n    } else {\r\n        // check if the email div exists\r\n        const emailDiv = document.getElementById(\"salesforce-email-txt\");\r\n        if (emailDiv) {\r\n            document.getElementById(\"saleforce-email\").removeChild(emailDiv);\r\n        }\r\n    }\r\n});\r\n\r\ndocument.getElementById(\"midwinter-email-label\").addEventListener(\"change\", function () {\r\n    if (this.checked) {\r\n        const midwinterEmail = document.getElementById(\"midwinter-email-label\").value;\r\n        const groupSelect = document.getElementById(\"group-data\");\r\n        const selectedOption = groupSelect.options[groupSelect.selectedIndex];\r\n        const midwinter_emailSuffix = selectedOption.dataset.midwinter_emailSuffix || \"\";\r\n        const email = midwinter_emailSuffix;\r\n        if (midwinterEmail && midwinter_emailSuffix) {\r\n            // create a txt div to show the email\r\n            const emailDiv = document.createElement('div');\r\n            emailDiv.id = \"midwinter-email-txt\";\r\n            emailDiv.textContent = email;\r\n            emailDiv.style.color = \"green\";\r\n            document.getElementById(\"midwinter-email\").appendChild(emailDiv);\r\n        } else {\r\n            const emailDiv = document.createElement('div');\r\n            emailDiv.id = \"midwinter-email-txt\";\r\n            emailDiv.textContent = \"Invalid email address\";\r\n            // color the text red\r\n            emailDiv.style.color = \"red\";\r\n            document.getElementById(\"midwinter-email\").appendChild(emailDiv);\r\n        }\r\n    } else {\r\n        // check if the email div exists\r\n        const emailDiv = document.getElementById(\"midwinter-email-txt\");\r\n        if (emailDiv) {\r\n            document.getElementById(\"midwinter-email\").removeChild(emailDiv);\r\n        }\r\n    }\r\n});\r\n\r\nfunction sendEmail(emailTitle, emailContent, recipientEmail, id) {\r\n    if (recipientEmail) {\r\n        if (Office.context.mailbox && Office.context.mailbox.item) {\r\n            const item = Office.context.mailbox.item;\r\n            const toRecipients = [recipientEmail];\r\n            item.forward(\r\n                {\r\n                    toRecipients: toRecipients,\r\n                    subject: \"Fwd: \" + emailTitle + \"(ref: \" + id + \")\",\r\n                    body: \"Please see the forwarded email below:\\n\\n\" + emailContent\r\n                },\r\n                function (asyncResult) {\r\n                    if (asyncResult.status === Office.AsyncResultStatus.Succeeded) {\r\n                        console.log(\"Email forwarded successfully.\");\r\n                    } else {\r\n                        console.error(\"Failed to forward email:\", asyncResult.error.message);\r\n                    }\r\n                }\r\n            );\r\n        }\r\n    }\r\n}","// Imports\nvar ___HTML_LOADER_IMPORT_0___ = new URL(\"./crm.css\", import.meta.url);\nvar ___HTML_LOADER_IMPORT_1___ = new URL(\"../../assets/hide_50.png\", import.meta.url);\nvar ___HTML_LOADER_IMPORT_2___ = new URL(\"../../assets/show_50.png\", import.meta.url);\nvar ___HTML_LOADER_IMPORT_3___ = new URL(\"./datepicker.js\", import.meta.url);\n// Module\nvar code = \"<!DOCTYPE html> <html> <head> <title>Worksorted CRM</title> <link href=\\\"https://cdn.jsdelivr.net/npm/select2@4.0.13/dist/css/select2.min.css\\\" rel=\\\"stylesheet\\\"> <link rel=\\\"stylesheet\\\" href=\\\"https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css\\\" crossorigin=\\\"anonymous\\\"> <\" + \"script src=\\\"https://cdn.jsdelivr.net/npm/flatpickr\\\"><\" + \"/script> <\" + \"script src=\\\"https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js\\\"><\" + \"/script> <\" + \"script src=\\\"https://cdn.jsdelivr.net/npm/select2@4.0.13/dist/js/select2.min.js\\\"><\" + \"/script> <\" + \"script src=\\\"https://cdn.ckeditor.com/ckeditor5/41.1.0/classic/ckeditor.js\\\"><\" + \"/script> <\" + \"script src=\\\"https://appsforoffice.microsoft.com/lib/1/hosted/office.js\\\"><\" + \"/script> <link href=\\\"\" + ___HTML_LOADER_IMPORT_0___ + \"\\\" rel=\\\"stylesheet\\\"/> </head> <body> <div id=\\\"overlay\\\" style=\\\"display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,.5);z-index:9999\\\"></div> <div id=\\\"sidebar\\\"> <button id=\\\"arrow-left\\\"> <img id=\\\"arrowIcon_hide\\\" src=\\\"\" + ___HTML_LOADER_IMPORT_1___ + \"\\\" alt=\\\"Arrow\\\"/> </button> <div style=\\\"display:flex;align-items:center\\\"> <h4 style=\\\"margin:0;width:120px\\\">Note Summary</h4> <input type=\\\"text\\\" id=\\\"noteTitle\\\" placeholder=\\\"Note Title\\\"> </div> <h4 style=\\\"margin-bottom:0\\\">Email Content</h4> <div id=\\\"editor\\\" style=\\\"width:100%;border:1px solid #ccc;overflow:auto;margin-top:0\\\"></div> </div> <div id=\\\"mainContent\\\"> <div id=\\\"crmData\\\"></div> <div id=\\\"btn-css\\\"> <button id=\\\"toggleSidebar\\\" title=\\\"show email\\\"> <img id=\\\"arrowIcon_show\\\" src=\\\"\" + ___HTML_LOADER_IMPORT_2___ + \"\\\" alt=\\\"Arrow\\\"/> </button> <br> <br> <button id=\\\"myButton\\\">Creat New Job</button> </div> <div id=\\\"general-info\\\"> <div id=\\\"group-box\\\" style=\\\"display:flex;align-items:center;margin-bottom:10px;margin-top:10px\\\"> <div style=\\\"width:80px\\\">Group</div> <select id=\\\"group-data\\\" title=\\\"Group Data\\\" style=\\\"width:60%\\\"> <option value=\\\"\\\">Loading...</option> </select> </div> <div id=\\\"noteType-box\\\" style=\\\"display:flex;align-items:center;margin-bottom:10px\\\"> <div style=\\\"width:80px\\\">Note Type:</div> <select id=\\\"notetype\\\" title=\\\"Note Type\\\" style=\\\"width:60%\\\"> <option value=\\\"0\\\">File Note</option> <option value=\\\"1\\\">Client Job Note</option> <option value=\\\"2\\\">Non-Client Job Note</option> </select> </div> <div id=\\\"client-box\\\" style=\\\"display:flex;align-items:center;margin-bottom:10px\\\"> <div style=\\\"width:80px\\\">Client:</div> <select id=\\\"client\\\" title=\\\"Client\\\" style=\\\"width:60%\\\"></select> </div> <div id=\\\"job-box\\\"> <div id=\\\"row-job-box\\\"> <div style=\\\"width:80px;display:flex;align-items:center\\\">Job:</div> <select id=\\\"job\\\" title=\\\"Job\\\" style=\\\"width:200px\\\" multiple=\\\"multiple\\\"></select> </div> <div id=\\\"closejob-box\\\"> <label for=\\\"closejob\\\" style=\\\"margin-right:5px\\\"> <input type=\\\"checkbox\\\" id=\\\"closejob\\\"/>close job </label> <div id=\\\"closejob-container\\\" style=\\\"display:none\\\"> <label>Hours: <input type=\\\"number\\\" id=\\\"closejob-hours\\\" min=\\\"0\\\" step=\\\"1\\\"></label> <label>Minutes: <input type=\\\"number\\\" id=\\\"closejob-minutes\\\" min=\\\"0\\\" max=\\\"59\\\" step=\\\"1\\\"></label> </div> </div> </div> <div id=\\\"attachment-box\\\" style=\\\"display:flex;align-items:center;margin-bottom:10px\\\"> <div style=\\\"width:80px\\\">Attachment:</div> <div class=\\\"radio-option\\\"> <input type=\\\"radio\\\" id=\\\"include\\\" name=\\\"attachmentOption\\\" value=\\\"1\\\"> <label for=\\\"include\\\">Include</label> </div> <div class=\\\"radio-option\\\"> <input type=\\\"radio\\\" id=\\\"exclude\\\" name=\\\"attachmentOption\\\" value=\\\"0\\\" checked=\\\"checked\\\"> <label for=\\\"exclude\\\">Exclude</label> </div> </div> <div id=\\\"send-copy-note-box\\\"> <div id=\\\"xplan-email\\\" style=\\\"display:none\\\"> <label><input type=\\\"checkbox\\\" id=\\\"xplan-email-label\\\"/> Send copy of note to Xplan</label> </div> <div id=\\\"saleforce-email\\\" style=\\\"display:none\\\"> <label><input type=\\\"checkbox\\\" id=\\\"saleforce-email-label\\\"/> Send copy of note to Salesforce</label> </div> <div id=\\\"midwinter-email\\\" style=\\\"display:none\\\"> <label><input type=\\\"checkbox\\\" id=\\\"midwinter-email-label\\\"/> Send copy of note to Midwinter</label> </div> </div> </div> <div id=\\\"optional\\\"> <div id=\\\"filenote-option\\\"> <div class=\\\"option-css\\\"> <div id=\\\"effectivedate-box\\\" style=\\\"display:flex;margin-bottom:10px\\\"> <label for=\\\"effectiveDateTime\\\"> <input type=\\\"checkbox\\\" id=\\\"effectiveDateTime\\\"/> Effective Date Time </label> <div id=\\\"datetime-container\\\" style=\\\"display:none\\\"> <input type=\\\"datetime-local\\\" id=\\\"datetime-picker\\\"/> </div> </div> <div id=\\\"category-box\\\" style=\\\"margin-bottom:10px\\\"> <label> <input type=\\\"checkbox\\\" id=\\\"category\\\"/> Category </label> <div id=\\\"category-container\\\" style=\\\"display:none\\\"> <select id=\\\"category-select\\\"> <option value=\\\"\\\">Select Category</option> </select> <select id=\\\"sub-category-select\\\"> <option value=\\\"\\\">Select Sub-Category</option> </select> </div> </div> <div id=\\\"sharenote-box\\\" style=\\\"margin-bottom:10px\\\"> <label> <input type=\\\"checkbox\\\" id=\\\"sharenote\\\"/> Share Note with </label> <div id=\\\"sharenote-container\\\" style=\\\"display:none\\\"> <select id=\\\"sharenote-select\\\" multiple=\\\"multiple\\\"> <option value=\\\"\\\">Select User</option> </select> </div> </div> </div> <button id=\\\"add-file-note-btn\\\">Add File Note</button> </div> <div id=\\\"jobnote-option\\\"> <div class=\\\"option-css\\\"> <div id=\\\"jobnote-due-date-box\\\" class=\\\"jobnote-option-margin\\\"> <label for=\\\"jobnoteduedate\\\"> <input type=\\\"checkbox\\\" id=\\\"jobnote-duedate\\\"/> Due Date </label> <div id=\\\"jobnote-duedate-container\\\" style=\\\"display:none\\\"> <input type=\\\"datetime-local\\\" id=\\\"jobnote-duedate-picker\\\"/> </div> </div> <div id=\\\"jobnote-followup-date-box\\\" class=\\\"jobnote-option-margin\\\"> <label for=\\\"jobnotefollowup\\\"> <input type=\\\"checkbox\\\" id=\\\"jobnote-followupdate\\\"/> Follow-up Date </label> <div id=\\\"jobnote-followupdate-container\\\" style=\\\"display:none\\\"> <input type=\\\"datetime-local\\\" id=\\\"jobnote-followupdate-picker\\\"/> </div> </div> <div id=\\\"jobnote-effective-date-box\\\" class=\\\"jobnote-option-margin\\\"> <label for=\\\"jobnoteeffectivedate\\\"> <input type=\\\"checkbox\\\" id=\\\"jobnote-effectivedate\\\"/> Effective Date </label> <div id=\\\"jobnote-effectivedate-container\\\" style=\\\"display:none\\\"> <input type=\\\"datetime-local\\\" id=\\\"jobnote-effectivedate-picker\\\"/> </div> </div> <div id=\\\"notify-owner-box\\\" class=\\\"jobnote-option-margin\\\"> <input type=\\\"checkbox\\\" id=\\\"jobnote-owner\\\"/> Notify Owner by Email </div> <div id=\\\"notify-assigned-box\\\" class=\\\"jobnote-option-margin\\\"> <input type=\\\"checkbox\\\" id=\\\"jobnote-assigned\\\"/> Notify Assigned by Email </div> <div id=\\\"notify-observer-box\\\" class=\\\"jobnote-option-margin\\\"> <input type=\\\"checkbox\\\" id=\\\"jobnote-observer\\\"/> Notify Observer by Email </div> </div> <button id=\\\"add-job-note-btn\\\">Add Job Note</button> </div> </div> </div> <\" + \"script src=\\\"\" + ___HTML_LOADER_IMPORT_3___ + \"\\\"><\" + \"/script> <\" + \"script><\" + \"/script> </body> </html>\";\n// Exports\nexport default code;"],"names":["__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","exports","module","__webpack_modules__","m","g","globalThis","this","Function","e","window","o","obj","prop","Object","prototype","hasOwnProperty","call","scriptUrl","importScripts","location","document","currentScript","tagName","toUpperCase","src","scripts","getElementsByTagName","length","i","test","Error","replace","p","b","baseURI","self","href","_regeneratorRuntime","t","r","n","defineProperty","value","Symbol","a","iterator","c","asyncIterator","u","toStringTag","define","enumerable","configurable","writable","wrap","Generator","create","Context","makeInvokeMethod","tryCatch","type","arg","h","l","f","s","y","GeneratorFunction","GeneratorFunctionPrototype","d","getPrototypeOf","v","values","defineIteratorMethods","forEach","_invoke","AsyncIterator","invoke","_typeof","resolve","__await","then","callInvokeWithMethodAndArg","done","method","delegate","maybeInvokeDelegate","sent","_sent","dispatchException","abrupt","return","TypeError","resultName","next","nextLoc","pushTryEntry","tryLoc","catchLoc","finallyLoc","afterLoc","tryEntries","push","resetTryEntry","completion","reset","isNaN","displayName","isGeneratorFunction","constructor","name","mark","setPrototypeOf","__proto__","awrap","async","Promise","keys","reverse","pop","prev","charAt","slice","stop","rval","handle","complete","finish","catch","delegateYield","asyncGeneratorStep","_asyncToGenerator","arguments","apply","_next","_throw","dialog","openDialog","_openDialog","_callee3","groupOptions","clientOptions","noteTitle","noteContent","attachments","data","_context3","getElementById","style","display","Array","from","options","map","option","text","selected","editorInstance","getData","getAttachments","localStorage","setItem","userId","JSON","stringify","Office","context","ui","displayDialogAsync","height","width","asyncResult","status","AsyncResultStatus","Succeeded","addEventHandler","EventType","DialogEventReceived","closeDialog","DialogMessageReceived","message","console","log","MailboxEnums","ItemNotificationMessageType","InformationalMessage","icon","persistent","mailbox","item","notificationMessages","replaceAsync","error","close","onReady","info","host","HostType","Outlook","_checkLoginStatus","checkLoginStatus","onclick","_callee4","storedUniqueId","response","_context4","getItem","fetch","headers","body","concat","json","loadCrmData","t0","innerHTML","addEventListener","toggleSidebar","toggleSidebar1","fetchGroups","groups","groupSelect","group","createElement","groupId","textContent","groupName","dataset","xplan_emailSuffix","pushEmailAddress","salesforce_emailSuffix","salesforceEmail","midwinter_emailSuffix","MidwinterEmail","appendChild","loadClients","getAsync","CoercionType","Html","result","emailContent","emailSubject","subject","fromName","emailAddress","toNames","to","recipient","join","receivedTime","Date","dateTimeCreated","toLocaleString","infoDiv","fullContent","includes","match","editor","setData","sidebar","classList","add","remove","fetchClients","clients","clientSelect","client","entityId","entityName","xplanEmail","XPlanID","SalesforceID","midwinterEmail","MidwinterID","$","select2","placeholder","allowClear","trigger","loadCategories","categories","categorySelect","category","notecategoryId","notecategoryName","loadSubCategories","categoryId","subCategories","subCategorySelect","subCategory","id","loadSharedClient","entities","sharenoteSelect","isArray","entity","_getAttachments","_callee5","_context5","reject","attachmentData","attachment","attachmentType","getAttachmentContentAsync","fileName","fileContent","content","fileType","contentType","fileSize","size","sendAttachmentsToServer","_x","_sendAttachmentsToServer","_callee6","_context6","encodeURIComponent","attachmentIds","loadClientJob","jobs","jobSelect","job","jobId","jobTitle","sendEmail","emailTitle","recipientEmail","toRecipients","forward","on","selectedGroupId","checked","val","xplanEmailCheckbox","salesforceEmailCheckbox","midwinterEmailCheckbox","selectedOption","selectedIndex","trim","xplan_emailDiv","removeChild","saleforce_emailDiv","midwinter_emailDiv","categoryContainer","shareNoteContainer","_callee","selectedRadio","selectGroupId","selectClientId","effectiveDateTimeValue","subCategoryId","shareNote","selectedOptions","_response","overlay","_dialog","_context","querySelector","className","reload","t1","noteType","disabled","currentGroupId","currentEntityId","_callee2","dueDateValue","followUpDateValue","effectiveDateValue","closejob","closeJob_hrs","closeJob_mins","notifyOwner","notifyAssignedTo","notifyObserver","jobIds","_response2","_dialog2","_context2","$entityId","email","emailDiv","color","URL"],"sourceRoot":""}