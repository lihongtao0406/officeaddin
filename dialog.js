/*! For license information please see dialog.js.LICENSE.txt */
!function(){function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(){"use strict";t=function(){return r};var n,r={},o=Object.prototype,a=o.hasOwnProperty,c=Object.defineProperty||function(e,t,n){e[t]=n.value},i="function"==typeof Symbol?Symbol:{},s=i.iterator||"@@iterator",l=i.asyncIterator||"@@asyncIterator",d=i.toStringTag||"@@toStringTag";function u(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(n){u=function(e,t,n){return e[t]=n}}function p(e,t,n,r){var o=t&&t.prototype instanceof b?t:b,a=Object.create(o.prototype),i=new C(r||[]);return c(a,"_invoke",{value:O(e,n,i)}),a}function h(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}r.wrap=p;var f="suspendedStart",m="suspendedYield",y="executing",g="completed",v={};function b(){}function E(){}function w(){}var I={};u(I,s,(function(){return this}));var k=Object.getPrototypeOf,x=k&&k(k(D([])));x&&x!==o&&a.call(x,s)&&(I=x);var j=w.prototype=b.prototype=Object.create(I);function B(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function S(t,n){function r(o,c,i,s){var l=h(t[o],t,c);if("throw"!==l.type){var d=l.arg,u=d.value;return u&&"object"==e(u)&&a.call(u,"__await")?n.resolve(u.__await).then((function(e){r("next",e,i,s)}),(function(e){r("throw",e,i,s)})):n.resolve(u).then((function(e){d.value=e,i(d)}),(function(e){return r("throw",e,i,s)}))}s(l.arg)}var o;c(this,"_invoke",{value:function(e,t){function a(){return new n((function(n,o){r(e,t,n,o)}))}return o=o?o.then(a,a):a()}})}function O(e,t,r){var o=f;return function(a,c){if(o===y)throw Error("Generator is already running");if(o===g){if("throw"===a)throw c;return{value:n,done:!0}}for(r.method=a,r.arg=c;;){var i=r.delegate;if(i){var s=T(i,r);if(s){if(s===v)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(o===f)throw o=g,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=y;var l=h(e,t,r);if("normal"===l.type){if(o=r.done?g:m,l.arg===v)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(o=g,r.method="throw",r.arg=l.arg)}}}function T(e,t){var r=t.method,o=e.iterator[r];if(o===n)return t.delegate=null,"throw"===r&&e.iterator.return&&(t.method="return",t.arg=n,T(e,t),"throw"===t.method)||"return"!==r&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+r+"' method")),v;var a=h(o,e.iterator,t.arg);if("throw"===a.type)return t.method="throw",t.arg=a.arg,t.delegate=null,v;var c=a.arg;return c?c.done?(t[e.resultName]=c.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=n),t.delegate=null,v):c:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,v)}function L(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function A(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function C(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(L,this),this.reset(!0)}function D(t){if(t||""===t){var r=t[s];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,c=function e(){for(;++o<t.length;)if(a.call(t,o))return e.value=t[o],e.done=!1,e;return e.value=n,e.done=!0,e};return c.next=c}}throw new TypeError(e(t)+" is not iterable")}return E.prototype=w,c(j,"constructor",{value:w,configurable:!0}),c(w,"constructor",{value:E,configurable:!0}),E.displayName=u(w,d,"GeneratorFunction"),r.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===E||"GeneratorFunction"===(t.displayName||t.name))},r.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,w):(e.__proto__=w,u(e,d,"GeneratorFunction")),e.prototype=Object.create(j),e},r.awrap=function(e){return{__await:e}},B(S.prototype),u(S.prototype,l,(function(){return this})),r.AsyncIterator=S,r.async=function(e,t,n,o,a){void 0===a&&(a=Promise);var c=new S(p(e,t,n,o),a);return r.isGeneratorFunction(t)?c:c.next().then((function(e){return e.done?e.value:c.next()}))},B(j),u(j,d,"Generator"),u(j,s,(function(){return this})),u(j,"toString",(function(){return"[object Generator]"})),r.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},r.values=D,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=n,this.done=!1,this.delegate=null,this.method="next",this.arg=n,this.tryEntries.forEach(A),!e)for(var t in this)"t"===t.charAt(0)&&a.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=n)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(r,o){return i.type="throw",i.arg=e,t.next=r,o&&(t.method="next",t.arg=n),!!o}for(var o=this.tryEntries.length-1;o>=0;--o){var c=this.tryEntries[o],i=c.completion;if("root"===c.tryLoc)return r("end");if(c.tryLoc<=this.prev){var s=a.call(c,"catchLoc"),l=a.call(c,"finallyLoc");if(s&&l){if(this.prev<c.catchLoc)return r(c.catchLoc,!0);if(this.prev<c.finallyLoc)return r(c.finallyLoc)}else if(s){if(this.prev<c.catchLoc)return r(c.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<c.finallyLoc)return r(c.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&a.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var o=r;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var c=o?o.completion:{};return c.type=e,c.arg=t,o?(this.method="next",this.next=o.finallyLoc,v):this.complete(c)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),v},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),A(n),v}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;A(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:D(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=n),v}},r}function n(e,t,n,r,o,a,c){try{var i=e[a](c),s=i.value}catch(e){return void n(e)}i.done?t(s):Promise.resolve(s).then(r,o)}function r(e){return function(){var t=this,r=arguments;return new Promise((function(o,a){var c=e.apply(t,r);function i(e){n(c,o,a,i,s,"next",e)}function s(e){n(c,o,a,i,s,"throw",e)}i(void 0)}))}}function o(e,t){var n=document.getElementById(e);n.innerHTML="",t.forEach((function(e){var t=document.createElement("option");t.value=e.value,t.textContent=e.text,e.selected&&(t.selected=!0),n.appendChild(t)}))}function a(e){$(e).select2({placeholder:"Search or select",allowClear:!0})}function c(e){return i.apply(this,arguments)}function i(){return(i=r(t().mark((function e(n){var r,o,a;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("http://localhost/outlookAddin/webgetEntities.php?groupId=".concat(n));case 3:if((r=e.sent).ok){e.next=6;break}throw new Error("HTTP error! Status: ".concat(r.status));case 6:return e.next=8,r.json();case 8:o=e.sent,(a=document.getElementById("client")).innerHTML="",Array.isArray(o)&&o.forEach((function(e){var t=document.createElement("option");t.value=e.entityId,t.textContent="".concat(e.entityName," - ").concat(e.entityId),t.dataset.xplanEmail=e.XPlanID||"",t.dataset.salesforceEmail=e.SalesforceID||"",t.dataset.midwinterEmail=e.MidwinterID||"",a.appendChild(t)})),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(0),console.error("Error loading client data:",e.t0);case 17:case"end":return e.stop()}}),e,null,[[0,14]])})))).apply(this,arguments)}function s(e,t){return l.apply(this,arguments)}function l(){return(l=r(t().mark((function e(n,r){var o,a,c;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("http://localhost/outlookAddin/webgetEntityShare.php?groupId=".concat(n,"&entityId=").concat(r));case 3:if((o=e.sent).ok){e.next=6;break}throw new Error("HTTP error! Status: ".concat(o.status));case 6:return e.next=8,o.json();case 8:a=e.sent,console.log(a),(c=document.getElementById("share-client")).innerHTML="",Array.isArray(a)&&a.forEach((function(e){var t=document.createElement("option");t.value=e.entityId,t.textContent=e.entityName,c.appendChild(t)})),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(0),console.error("Error loading shared client data:",e.t0);case 18:case"end":return e.stop()}}),e,null,[[0,15]])})))).apply(this,arguments)}function d(e){return u.apply(this,arguments)}function u(){return(u=r(t().mark((function e(n){var r,o,a,c;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("http://localhost/outlookAddin/webgetJobTypes.php?groupId=".concat(n));case 3:if((r=e.sent).ok){e.next=6;break}throw new Error("HTTP error! Status: ".concat(r.status));case 6:return e.next=8,r.json();case 8:if(o=e.sent,(a=document.getElementById("jobtype-select")).innerHTML="",!Array.isArray(o)){e.next=17;break}return o.forEach((function(e){var t=document.createElement("option");t.value=e.jobtypeid,t.textContent=e.jobtype,a.appendChild(t)})),c=o[0].jobtypeid,$("#jobtype-select").val(c).trigger("change"),e.next=17,p(n,c);case 17:$("#jobtype-select").select2({placeholder:"Search or select",allowClear:!0}),$("#jobtitle-select").select2({placeholder:"Search or select",allowClear:!0}),e.next=24;break;case 21:e.prev=21,e.t0=e.catch(0),console.error("Error loading job type data:",e.t0);case 24:case"end":return e.stop()}}),e,null,[[0,21]])})))).apply(this,arguments)}function p(e,t){return h.apply(this,arguments)}function h(){return(h=r(t().mark((function e(n,r){var o,a,c,i;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("http://localhost/outlookAddin/webgetJobDefaultTitles.php?groupId=".concat(n,"&jobTypeId=").concat(r));case 3:if((o=e.sent).ok){e.next=6;break}throw new Error("HTTP error! Status: ".concat(o.status));case 6:return e.next=8,o.json();case 8:a=e.sent,(c=document.getElementById("jobtitle-select")).innerHTML="",Array.isArray(a)&&a.forEach((function(e){var t=document.createElement("option");t.value=e.id,t.textContent=e.defaultJobTitle,c.appendChild(t)})),a.length>0&&(i=a[0].id,$("#jobtitle-select").val(i).trigger("change")),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(0),console.error("Error loading job title data:",e.t0);case 18:case"end":return e.stop()}}),e,null,[[0,15]])})))).apply(this,arguments)}function f(e,t){return m.apply(this,arguments)}function m(){return(m=r(t().mark((function e(n,r){var o,a,c,i,s;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("http://localhost/outlookAddin/webgetUsers.php?groupId=".concat(n));case 3:if((o=e.sent).ok){e.next=6;break}throw new Error("HTTP error! Status: ".concat(o.status));case 6:return e.next=8,o.json();case 8:a=e.sent,document.getElementById(r).innerHTML="",c=[{id:"-1",text:"Primary Adviser"},{id:"-2",text:"Secondary Adviser"},{id:"-3",text:"Support Staff"},{id:"-4",text:"Client Owner"},{id:"-5",text:"Insurance Adviser"},{id:"-6",text:"Mortgage Adviser"},{id:"-7",text:"Investment Adviser"},{id:"-8",text:"Paraplanner"},{id:"-9",text:"To Be Assigned"},{id:"-10",text:"Compliance Officer"},{id:"-11",text:"Outsourced Support"},{id:"-12",text:"Administration Officer"}],i=Array.isArray(a)?a.map((function(e){return{id:e.userId,text:e.name}})):[],s=[],document.getElementById("non-client-job").checked||s.push({text:"--------Respective Adviser--------",children:c}),Array.isArray(a)&&a.length>0&&s.push({text:"--------My Contant--------",children:i}),$("#".concat(r)).empty().select2({placeholder:"Search or select",allowClear:!0,data:s}),e.next=22;break;case 19:e.prev=19,e.t0=e.catch(0),console.error("Error loading user data:",e.t0);case 22:case"end":return e.stop()}}),e,null,[[0,19]])})))).apply(this,arguments)}function y(e,t){document.getElementById(e).addEventListener("change",(function(){var n=document.getElementById("".concat(e,"-container"));this.checked?(f($("#group-data").val(),t),n.style.display="block"):n.style.display="none"}))}function g(e){return v.apply(this,arguments)}function v(){return(v=r(t().mark((function e(n){var r,o;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("http://localhost/outlookAddin/webattachmentReceiver.php",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:"attachments="+encodeURIComponent(JSON.stringify(n))});case 2:return r=e.sent,e.next=5,r.json();case 5:if("success"!==(o=e.sent).status||!o.attachmentIds){e.next=10;break}return e.abrupt("return",o.attachmentIds);case 10:throw new Error("No attachment IDs returned from server.");case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}Office.onReady((function(e){if(e.host===Office.HostType.Outlook){var t=JSON.parse(localStorage.getItem("dialogData"));console.log(t),o("group-data",t.groupOptions),o("client",t.clientOptions),document.getElementById("noteSummary").value=t.noteTitle,console.log(t.noteContent);var n=window.editorInstance;n?(n.setData(t.noteContent),document.getElementById("noteSummary").value=t.noteTitle):console.error("CKEditor instance is not available."),a("#group-data"),a("#client"),a("#share-client")}else console.error("This add-in only supports Outlook.")})),$("#group-data").on("change",r(t().mark((function e(){var n,r;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.value,e.next=3,c(n);case 3:return r=$("#client").val(),e.next=6,s(n,r);case 6:if(!$("#jobtype").is(":checked")){e.next=9;break}return e.next=9,d(n);case 9:$("#owner").is(":checked")&&f(n,"owner-select"),$("#assigned").is(":checked")&&f(n,"assigned-select"),$("#observer").is(":checked")&&f(n,"observer-select");case 12:case"end":return e.stop()}}),e,this)})))),$("#client").on("change",r(t().mark((function e(){var n,r;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.value,r=$("#group-data").val(),e.next=4,s(r,n);case 4:case"end":return e.stop()}}),e,this)})))),document.getElementById("jobnote-duedate").addEventListener("change",(function(){var e=document.getElementById("jobnote-duedate-container");if(this.checked){var t=new Date;t.setMinutes(t.getMinutes()-t.getTimezoneOffset()),document.getElementById("jobnote-duedate-picker").value=t.toISOString().slice(0,16),e.style.display="block"}else e.style.display="none"})),document.getElementById("jobnote-effectivedate").addEventListener("change",(function(){var e=document.getElementById("jobnote-effectivedate-container");if(this.checked){e.style.display="block";var t=new Date;t.setMinutes(t.getMinutes()-t.getTimezoneOffset()),document.getElementById("jobnote-effectivedate-picker").value=t.toISOString().slice(0,16)}else e.style.display="none"})),document.getElementById("jobnote-completedate").addEventListener("change",(function(){var e=document.getElementById("jobnote-completedate-container");if(this.checked){e.style.display="block";var t=new Date;t.setMinutes(t.getMinutes()-t.getTimezoneOffset()),document.getElementById("jobnote-completedate-picker").value=t.toISOString().slice(0,16)}else e.style.display="none"})),document.getElementById("jobnote-followupdate").addEventListener("change",(function(){var e=document.getElementById("jobnote-followupdate-container");if(this.checked){e.style.display="block";var t=new Date;t.setMinutes(t.getMinutes()-t.getTimezoneOffset()),document.getElementById("jobnote-followupdate-picker").value=t.toISOString().slice(0,16)}else e.style.display="none"})),document.getElementById("jobtype").addEventListener("change",r(t().mark((function e(){var n,r,o;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=document.getElementById("jobtype-container"),r=document.getElementById("jot-title-div"),!this.checked){e.next=10;break}return o=$("#group-data").val(),e.next=6,d(o);case 6:n.style.display="block",r.style.display="flex",e.next=12;break;case 10:n.style.display="none",r.style.display="none";case 12:case"end":return e.stop()}}),e,this)})))),$("#jobtype-select").on("change",r(t().mark((function e(){var n,r;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=$("#group-data").val(),r=this.value,e.next=4,p(n,r);case 4:case"end":return e.stop()}}),e,this)})))),$("#jobtitle-select").on("change",(function(){var e=$(this).find("option:selected").text();document.getElementById("jobtitle").value=e})),y("owner","owner-select"),y("assigned","assigned-select"),y("observer","observer-select"),document.getElementById("recurring").addEventListener("change",(function(){var e=document.getElementById("recurring-container"),t=document.getElementById("jobnote-due-date-box");if(this.checked){e.style.display="block",t.style.display="none";var n=new Date;n.setMinutes(n.getMinutes()-n.getTimezoneOffset()),document.getElementById("first-due-date-picker").value=n.toISOString().slice(0,16),document.getElementById("jobnote-duedate").checked=!1}else e.style.display="none",t.style.display="flex",document.getElementById("jobnote-duedate-container").style.display="none"})),document.getElementById("end-date").addEventListener("change",(function(){var e=document.getElementById("end-date-container");if(this.checked){e.style.display="block";var t=new Date;t.setMinutes(t.getMinutes()-t.getTimezoneOffset()),document.getElementById("end-date-picker").value=t.toISOString().slice(0,16)}else e.style.display="none"})),document.getElementById("non-client-job").addEventListener("change",(function(){var e=document.getElementById("client"),t=document.getElementById("share-client"),n=$("#group-data").val();document.getElementById("owner").checked&&f(n,"owner-select"),document.getElementById("assigned").checked&&f(n,"assigned-select"),document.getElementById("observer").checked&&f(n,"observer-select"),this.checked?(e.disabled=!0,t.disabled=!0):(e.disabled=!1,t.disabled=!1)})),document.getElementById("cancel").addEventListener("click",(function(){Office.context.ui.messageParent("close")})),document.getElementById("save").addEventListener("click",r(t().mark((function e(){var n,r,o,a,c,i,s,l,d,u,p,h,f,m,y,v,b,E,w,I,k,x,j,B,S,O,T,L,A,C,D,M,N,P,_,H,J,F,G,z,R,U,q;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=[],!(r=document.querySelector('input[name="attachmentOption"]:checked'))||"1"!==r.value){e.next=21;break}if(e.prev=3,o=JSON.parse(localStorage.getItem("dialogData")),0!==(a=o.attachments).length){e.next=10;break}n=[],e.next=14;break;case 10:return e.next=12,g(a);case 12:c=e.sent,n=c;case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(3),console.error("Error sending attachments:",e.t0);case 19:e.next=22;break;case 21:n=[];case 22:return i=$("#group-data").val(),s=$("#jobtitle").val(),l=$("#client").val(),d=[],u=Array.from(document.getElementById("share-client").selectedOptions),d=u.map((function(e){return e.value})),document.getElementById("non-client-job").checked&&(d=[],l=0),p=!!document.getElementById("copy-file-note").checked,h=document.getElementById("noteSummary").value,f=window.editorInstance.getData(),document.getElementById("jobnote-duedate").checked?(y=document.getElementById("jobnote-duedate-picker").value,m=new Date(y).toISOString().replace("T"," ").split(".")[0]):m="",document.getElementById("jobnote-effectivedate").checked?(b=document.getElementById("jobnote-effectivedate-picker").value,v=new Date(b).toISOString().replace("T"," ").split(".")[0]):v="",document.getElementById("jobnote-completedate").checked?(w=document.getElementById("jobnote-completedate-picker").value,E=new Date(w).toISOString().replace("T"," ").split(".")[0]):E="",document.getElementById("jobnote-followupdate").checked?(k=document.getElementById("jobnote-followupdate-picker").value,I=new Date(k).toISOString().replace("T"," ").split(".")[0]):I="",document.getElementById("jobtype").checked?(x=document.getElementById("jobtype-select").value,j=document.getElementById("jobtitle-select").value):(x=0,j=0),B=document.getElementById("owner").checked?document.getElementById("owner-select").value:0,S=document.getElementById("assigned").checked?document.getElementById("assigned-select").value:0,O=document.getElementById("observer").checked?document.getElementById("observer-select").value:0,T=!!document.getElementById("jobnote-owner").checked,L=!!document.getElementById("jobnote-assigned").checked,A=!!document.getElementById("jobnote-observer").checked,document.getElementById("recurring").checked?(C=!0,P=document.getElementById("first-due-date-picker").value,D=new Date(P).toISOString().replace("T"," ").split(".")[0],document.getElementById("end-date").checked?(_=document.getElementById("end-date-picker").value,M=new Date(_).toISOString().replace("T"," ").split(".")[0]):M="",N=document.getElementById("frequency").value):(C=!1,D="",M="",N=""),H=d.join(","),J=n.join(","),F=localStorage.getItem("current_login_userId"),G={groupId:i,userId:F,jobTitle:s,clientId:l,sharedClientIdsString:H,copyFileNote:p,noteSummary:h,noteContent:f,dueDate:m,effectiveDate:v,completeDate:E,followUpDate:I,jobTypeId:x,jobTitleId:j,ownerId:B,assignedId:S,observerId:O,jobNotifyOwner:T,jobNotifyAssigned:L,jobNotifyObserver:A,recurring:C,recurringFirstDueDate:D,recurringEndDate:M,recurringFrequency:N,attachmentIdsString:J},console.log("123444",G),e.prev=49,e.next=52,fetch("http://localhost/outlookAddin/webaddNewJob.php",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:"data="+encodeURIComponent(JSON.stringify(G))});case 52:return z=e.sent,e.next=55,z.json();case 55:"success"===(R=e.sent).status?(Office.context.ui.messageParent("newjob"),(U=document.createElement("div")).className="overlay",document.body.appendChild(U),(q=document.createElement("div")).className="dialog",q.innerHTML='\n                <p>Successfully Add</p>\n                <button id="close-dialog">OK</button>\n            ',document.body.appendChild(q),document.getElementById("close-dialog").addEventListener("click",(function(){document.body.removeChild(q),document.body.removeChild(U),location.reload()})),console.log("Job note saved successfully.")):console.error("Error saving job note:",R.message),e.next=62;break;case 59:e.prev=59,e.t1=e.catch(49),console.error("Error saving job note:",e.t1);case 62:case"end":return e.stop()}}),e,null,[[3,16],[49,59]])}))))}();
//# sourceMappingURL=dialog.js.map